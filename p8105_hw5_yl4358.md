p8105\_hw5\_yl4358
================
YI LIU
11/10/2019

# Problem 1

``` r
set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))

replace_iris_na = function(x_arg){
  if (is.numeric(x_arg)) {
   x_arg = replace(x_arg, is.na(x_arg), mean(x_arg,na.rm = TRUE))
  } else {
   x_arg = replace(x_arg, is.na(x_arg), "virginica") 
  }
}

output_iris = vector("list", length = 5)

for (i in 1:5) {
  
  output_iris[[i]] = replace_iris_na(x_arg = iris_with_missing[[i]])
}

final_iris = bind_cols(output_iris)
final_iris %>% 
 head(10) %>% 
  knitr::kable(digits = 2) 
```

|   V1 |  V2 |   V3 |   V4 | V5     |
| ---: | --: | ---: | ---: | :----- |
| 5.10 | 3.5 | 1.40 | 0.20 | setosa |
| 4.90 | 3.0 | 1.40 | 0.20 | setosa |
| 4.70 | 3.2 | 1.30 | 0.20 | setosa |
| 4.60 | 3.1 | 1.50 | 1.19 | setosa |
| 5.00 | 3.6 | 1.40 | 0.20 | setosa |
| 5.40 | 3.9 | 1.70 | 0.40 | setosa |
| 5.82 | 3.4 | 1.40 | 0.30 | setosa |
| 5.00 | 3.4 | 1.50 | 0.20 | setosa |
| 4.40 | 2.9 | 1.40 | 0.20 | setosa |
| 4.90 | 3.1 | 3.77 | 0.10 | setosa |

``` r
output_iris_map = map_df(iris_with_missing, replace_iris_na)

output_iris_map %>% 
 head(10) %>% 
  knitr::kable(digits = 2) 
```

| Sepal.Length | Sepal.Width | Petal.Length | Petal.Width | Species |
| -----------: | ----------: | -----------: | ----------: | :------ |
|         5.10 |         3.5 |         1.40 |        0.20 | setosa  |
|         4.90 |         3.0 |         1.40 |        0.20 | setosa  |
|         4.70 |         3.2 |         1.30 |        0.20 | setosa  |
|         4.60 |         3.1 |         1.50 |        1.19 | setosa  |
|         5.00 |         3.6 |         1.40 |        0.20 | setosa  |
|         5.40 |         3.9 |         1.70 |        0.40 | setosa  |
|         5.82 |         3.4 |         1.40 |        0.30 | setosa  |
|         5.00 |         3.4 |         1.50 |        0.20 | setosa  |
|         4.40 |         2.9 |         1.40 |        0.20 | setosa  |
|         4.90 |         3.1 |         3.77 |        0.10 | setosa  |
