p8105\_hw5\_yl4358
================
YI LIU
11/10/2019

# Problem 1

``` r
set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))

replace_iris_na = function(x_arg){
  if (is.numeric(x_arg)) {
   x_arg = replace(x_arg, is.na(x_arg), mean(x_arg,na.rm = TRUE))
  } else {
   x_arg = replace(x_arg, is.na(x_arg), "virginica") 
  }
}

output_iris = vector("list", length = 5)

for (i in 1:5) {
  
  output_iris[[i]] = replace_iris_na(x_arg = iris_with_missing[[i]])
}

final_iris = bind_cols(output_iris)
final_iris %>% 
 head(10) %>% 
  knitr::kable(digits = 2) 
```

|   V1 |  V2 |   V3 |   V4 | V5     |
| ---: | --: | ---: | ---: | :----- |
| 5.10 | 3.5 | 1.40 | 0.20 | setosa |
| 4.90 | 3.0 | 1.40 | 0.20 | setosa |
| 4.70 | 3.2 | 1.30 | 0.20 | setosa |
| 4.60 | 3.1 | 1.50 | 1.19 | setosa |
| 5.00 | 3.6 | 1.40 | 0.20 | setosa |
| 5.40 | 3.9 | 1.70 | 0.40 | setosa |
| 5.82 | 3.4 | 1.40 | 0.30 | setosa |
| 5.00 | 3.4 | 1.50 | 0.20 | setosa |
| 4.40 | 2.9 | 1.40 | 0.20 | setosa |
| 4.90 | 3.1 | 3.77 | 0.10 | setosa |

``` r
output_iris_map = map_df(iris_with_missing, replace_iris_na)

output_iris_map %>% 
 head(10) %>% 
  knitr::kable(digits = 2) 
```

| Sepal.Length | Sepal.Width | Petal.Length | Petal.Width | Species |
| -----------: | ----------: | -----------: | ----------: | :------ |
|         5.10 |         3.5 |         1.40 |        0.20 | setosa  |
|         4.90 |         3.0 |         1.40 |        0.20 | setosa  |
|         4.70 |         3.2 |         1.30 |        0.20 | setosa  |
|         4.60 |         3.1 |         1.50 |        1.19 | setosa  |
|         5.00 |         3.6 |         1.40 |        0.20 | setosa  |
|         5.40 |         3.9 |         1.70 |        0.40 | setosa  |
|         5.82 |         3.4 |         1.40 |        0.30 | setosa  |
|         5.00 |         3.4 |         1.50 |        0.20 | setosa  |
|         4.40 |         2.9 |         1.40 |        0.20 | setosa  |
|         4.90 |         3.1 |         3.77 |        0.10 | setosa  |

# Problem 2

``` r
long_df = tibble(
  file_names = list.files(path = "./data"),
  file_path = str_c("./data/", file_names)
  ) %>% 
  mutate(
    observation_df = map(file_path, read_csv)
  ) %>% 
  unnest() %>% 
  select(-file_path) %>% 
  separate(col = file_names, into = c("arm", "subject_id"), sep = "_") %>%
  mutate(
    arm = recode(arm, "con" = "control" , "exp" = "experimental"),
    subject_id = str_replace(subject_id, ".csv", " ")
  ) %>% 
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    names_prefix = "week_",
    values_to = "observation"
  )
```

    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## Parsed with column specification:
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )

    ## Warning: `cols` is now required.
    ## Please use `cols = c(observation_df)`

``` r
long_df %>% 
  group_by(arm,subject_id) %>% 
  ggplot(aes(x = week, y = observation, group = subject_id, color = subject_id)) +
  geom_line() +
  labs(
    title = "Observation on each subject overtime",
    x = "Week",
    y = "Observation"
     ) +
  facet_grid(.~arm)
```

<img src="p8105_hw5_yl4358_files/figure-gfm/unnamed-chunk-2-1.png" width="90%" />

  - The obeservation in experimental group is relative higher than that
    in control group.
